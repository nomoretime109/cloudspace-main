var v3=Object.defineProperty;var h3=(h,p,r)=>p in h?v3(h,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[p]=r;var f=(h,p,r)=>(h3(h,typeof p!="symbol"?p+"":p,r),r);import{Y as m3,_ as f3}from"./YMaskCard.49e64495.js";import{d as t3,o,c as n,a as s,q as _3,l as s3,s as _,r as w3,h as g3,j as b3,k as $,x as F3,y as k3,z as y3,b as x,m as M,t as D,A as d,F as O,B as X,i as A,w as K,v as Q,C as e3,u as x3,E as Y,D as C3,p as M3,f as D3,G as V3}from"./index.c51c43ce.js";import{_ as i3}from"./_plugin-vue_export-helper.cdc0426e.js";import{c as T}from"./axios.7b444a5e.js";const N3={class:"btn-container"},I3=t3({__name:"YButton",props:{height:{default:"43px"},width:{default:"160px"}},setup(h){const p=h;return(r,L)=>(o(),n("div",N3,[s("button",{style:s3({height:p.height,width:p.width}),class:"btn"},[_3(r.$slots,"default",{},void 0,!0)],4)]))}});const E3=i3(I3,[["__scopeId","data-v-4a61120b"]]),v=h=>(M3("data-v-4b404ac3"),h=h(),D3(),h),B3={class:"card"},S3={id:"sideCard"},z3={class:"menuContainer"},H3={class:"menuItem"},L3=v(()=>s("svg",{t:"1671204857123",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6487",width:"32",height:"32"},[s("path",{d:"M471.893333 149.333333a42.666667 42.666667 0 0 0-73.258666-29.781333l-343.893334 352.981333a42.666667 42.666667 0 0 0-0.768 58.709334l343.893334 372.352a42.666667 42.666667 0 0 0 73.984-28.928v-190.677334c56.917333-5.248 116.821333-1.365333 179.882666 11.989334 65.834667 13.994667 150.528 76.032 253.909334 202.24a42.666667 42.666667 0 0 0 75.477333-31.36c-15.445333-152.32-73.984-281.301333-176.170667-384.853334-92.757333-93.994667-204.373333-146.432-333.098666-156.586666V149.333333z",fill:"#e6e6e6","fill-opacity":".85","p-id":"6488"})],-1)),T3=v(()=>s("div",{class:"tooltip"},"\u8FD4\u56DE",-1)),A3=v(()=>s("svg",{t:"1671205618913",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7544",width:"32",height:"32"},[s("path",{d:"M311.466667 64c4.693333 0 8.533333 3.84 8.533333 8.533333v46.933334a8.533333 8.533333 0 0 1-8.533333 8.533333H234.666667a106.666667 106.666667 0 0 0-106.56 102.037333L128 234.666667v554.666666a106.666667 106.666667 0 0 0 102.037333 106.56L234.666667 896h554.666666a106.666667 106.666667 0 0 0 106.56-102.037333L896 789.333333V234.666667a106.666667 106.666667 0 0 0-102.037333-106.56L789.333333 128h-55.466666a8.533333 8.533333 0 0 1-8.533334-8.533333V72.533333c0-4.693333 3.84-8.533333 8.533334-8.533333H789.333333a170.666667 170.666667 0 0 1 170.666667 170.666667v554.666666a170.666667 170.666667 0 0 1-170.666667 170.666667H234.666667a170.666667 170.666667 0 0 1-170.666667-170.666667V234.666667a170.666667 170.666667 0 0 1 170.666667-170.666667h76.8z m212.138666 0l2.517334 0.298667c4.138667 0.746667 8.106667 2.709333 11.306666 5.909333l185.386667 185.386667a8.533333 8.533333 0 0 1 2.517333 6.058666v66.368a8.533333 8.533333 0 0 1-14.570666 6.037334L554.666667 177.962667V632.96a8.533333 8.533333 0 0 1-8.533334 8.533333h-46.933333a8.533333 8.533333 0 0 1-8.533333-8.533333V177.322667l-156.096 156.096a8.533333 8.533333 0 0 1-14.570667-6.037334v-66.346666a8.533333 8.533333 0 0 1 2.496-6.037334l184.768-184.789333A21.248 21.248 0 0 1 521.088 64h2.517333z",fill:"#e6e6e6","p-id":"7545"})],-1)),P3=v(()=>s("div",{class:"tooltip"},"\u4E0A\u4F20\u6587\u4EF6",-1)),U3=[A3,P3],$3=v(()=>s("svg",{t:"1671206543009",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"16208",width:"32",height:"32"},[s("path",{d:"M842.666667 285.866667l-187.733334-187.733334c-14.933333-14.933333-32-21.333333-53.333333-21.333333H234.666667C194.133333 74.666667 160 108.8 160 149.333333v725.333334c0 40.533333 34.133333 74.666667 74.666667 74.666666h554.666666c40.533333 0 74.666667-34.133333 74.666667-74.666666V337.066667c0-19.2-8.533333-38.4-21.333333-51.2z m-44.8 44.8H618.666667c-6.4 0-10.666667-4.266667-10.666667-10.666667V140.8l189.866667 189.866667z m-8.533334 554.666666H234.666667c-6.4 0-10.666667-4.266667-10.666667-10.666666V149.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h309.333333V320c0 40.533333 34.133333 74.666667 74.666667 74.666667h181.333333V874.666667c0 6.4-4.266667 10.666667-10.666667 10.666666z",fill:"#e6e6e6","p-id":"16209"}),s("path",{d:"M618.666667 586.666667h-74.666667V512c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v74.666667H405.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h74.666667V725.333333c0 17.066667 14.933333 32 32 32s32-14.933333 32-32v-74.666666H618.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z",fill:"#e6e6e6","p-id":"16210"})],-1)),O3=v(()=>s("div",{class:"tooltip"},"\u65B0\u5EFA\u6587\u4EF6",-1)),Y3=[$3,O3],R3=v(()=>s("div",{class:"menuItem"},[s("svg",{t:"1671206682427",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"16853",width:"32",height:"32"},[s("path",{d:"M512 1024C230.4 1024 0 793.6 0 512S230.4 0 512 0s512 230.4 512 512-230.4 512-512 512z m259.2-569.6H480c-12.8 0-25.6 12.8-25.6 25.6v64c0 12.8 12.8 25.6 25.6 25.6h176c12.8 0 25.6 12.8 25.6 25.6v12.8c0 41.6-35.2 76.8-76.8 76.8h-240c-12.8 0-25.6-12.8-25.6-25.6V416c0-41.6 35.2-76.8 76.8-76.8h355.2c12.8 0 25.6-12.8 25.6-25.6v-64c0-12.8-12.8-25.6-25.6-25.6H416c-105.6 0-188.8 86.4-188.8 188.8V768c0 12.8 12.8 25.6 25.6 25.6h374.4c92.8 0 169.6-76.8 169.6-169.6v-144c0-12.8-12.8-25.6-25.6-25.6z",fill:"#e6e6e6","p-id":"16854"})]),s("div",{class:"tooltip"},"\u4ECEgitee\u62C9\u53D6")],-1)),Z3={class:"content"},j3={class:"header"},q3={key:1,id:"currentDirectory"},G3={class:"filePathContainer"},J3=v(()=>s("div",{class:"filePathItem divider"},"/",-1)),W3=["onClick"],X3={key:1,id:"currentDirectory"},K3={class:"fileList"},Q3={key:0,t:"1671732414196",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2644",width:"32",height:"32"},e6=v(()=>s("path",{d:"M842.666667 285.866667l-187.733334-187.733334c-14.933333-14.933333-32-21.333333-53.333333-21.333333H234.666667C194.133333 74.666667 160 108.8 160 149.333333v725.333334c0 40.533333 34.133333 74.666667 74.666667 74.666666h554.666666c40.533333 0 74.666667-34.133333 74.666667-74.666666V337.066667c0-19.2-8.533333-38.4-21.333333-51.2z m-44.8 44.8c-2.133333 2.133333-4.266667 0-8.533334 0h-170.666666c-6.4 0-10.666667-4.266667-10.666667-10.666667V149.333333c0-2.133333 0-6.4-2.133333-8.533333 0 0 2.133333 0 2.133333 2.133333l189.866667 187.733334z m-8.533334 554.666666H234.666667c-6.4 0-10.666667-4.266667-10.666667-10.666666V149.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h311.466666c-2.133333 4.266667-2.133333 6.4-2.133333 10.666666v170.666667c0 40.533333 34.133333 74.666667 74.666667 74.666667h170.666666c4.266667 0 6.4 0 10.666667-2.133334V874.666667c0 6.4-4.266667 10.666667-10.666667 10.666666z",fill:"#666666","p-id":"2645"},null,-1)),t6=v(()=>s("path",{d:"M640 693.333333H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h298.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32zM640 522.666667H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h298.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32zM341.333333 416h85.333334c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32h-85.333334c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32z",fill:"#666666","p-id":"2646"},null,-1)),s6=[e6,t6],i6={key:1,t:"1671863859291",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2669",width:"32",height:"32"},o6=v(()=>s("path",{d:"M810.666667 85.333333a85.333333 85.333333 0 0 1 85.333333 85.333334v152.021333c36.821333 9.493333 64 42.88 64 82.645333v405.333334a128 128 0 0 1-128 128H192a128 128 0 0 1-128-128V298.666667a85.376 85.376 0 0 1 64-82.645334V170.666667a85.333333 85.333333 0 0 1 85.333333-85.333334h597.333334zM128.149333 296.170667L128 298.666667v512a64 64 0 0 0 60.245333 63.893333L192 874.666667h640a64 64 0 0 0 63.893333-60.245334L896 810.666667V405.333333a21.333333 21.333333 0 0 0-18.837333-21.184L874.666667 384H638.165333l-122.069333-101.717333a21.333333 21.333333 0 0 0-10.688-4.736l-2.986667-0.213334H149.333333a21.333333 21.333333 0 0 0-21.184 18.837334zM535.189333 213.333333l127.978667 106.666667H832V170.666667a21.333333 21.333333 0 0 0-18.837333-21.184L810.666667 149.333333H213.333333a21.333333 21.333333 0 0 0-21.184 18.837334L192 170.666667v42.666666h343.168z",fill:"#333333","p-id":"2670"},null,-1)),l6=[o6],n6={class:"fileName"},a6=["onClick"],c6={key:1,class:"renameDiv"},r6=["onUpdate:modelValue"],u6=["onClick"],d6=v(()=>s("svg",{t:"1671208100554",class:"icon",viewBox:"0 0 1026 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17969",width:"16",height:"16"},[s("path",{d:"M110.98112 510.74048m-110.98112 0a21.676 21.676 0 1 0 221.96224 0 21.676 21.676 0 1 0-221.96224 0Z",fill:"#231815","p-id":"17970"}),s("path",{d:"M512.93184 510.74048m-110.98112 0a21.676 21.676 0 1 0 221.96224 0 21.676 21.676 0 1 0-221.96224 0Z",fill:"#231815","p-id":"17971"}),s("path",{d:"M914.87744 510.74048m-110.98112 0a21.676 21.676 0 1 0 221.96224 0 21.676 21.676 0 1 0-221.96224 0Z",fill:"#231815","p-id":"17972"})],-1)),p6=[d6],v6={key:2,class:"tipMenuItem"},h6=["href"],m6=["src"],f6=v(()=>s("div",null,[A(" \u62D6\u62FD\u6587\u4EF6\u6216\u8005 "),s("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),_6=t3({__name:"FileManage",setup(h){const p=V3();class r{constructor(t){f(this,"visible");this.visible=t}}class L{constructor(t,l){f(this,"visible");f(this,"newName");this.visible=t,this.newName=l}}const u=_({token:"",username:""}),V=w3({fileNodes:[],fileMap:new Map}),o3=async function(){const e=localStorage.getItem("user");if(e!=null){const t=JSON.parse(e);u.token=t.token,u.username=t.username,await T.get("/usr/files",{params:{token:u.token}}).then(l=>{V.value.fileNodes=l.data.Data.fileNodes,V.value.fileMap=l.data.Data.fileMap,console.log("www:",V.value)}).catch(l=>{console.log(l)})}};class P{constructor(t,l,N,I,E){f(this,"id");f(this,"fileName");f(this,"type");f(this,"url");f(this,"renameComponent");this.id=l,this.fileName=t,this.type=N,this.url=I,this.renameComponent=E}}const l3=function(e,t){if(p!=null){const l=p.refs.fileTip;l.style.left=`${e.clientX+10}px`,l.style.top=`${e.clientY}px`,c.currentFile=t}c.display="block"},n3=function(e){console.log("x",e),y.title=e.fileName,e.type==".pdf"?e.url!=null&&(z.url=e.url,z.visible.visible=!0,y.visible=!0):e.type==".md"||e.type==".txt"?e.url!=null&&fetch(e.url).then(t=>t.text()).then(t=>{console.log(t),H.markdownText=t,H.visible.visible=!0,y.visible=!0}):e.type=="directory"&&(a.path.push(e),S(e),console.log(a.path),console.log("path:",b()))},R=_(new P("root",0,"directory","",new L(new r(!1),""))),a=_({path:[]}),b=function(){let e;e="";for(let t of a.path)e+=t.fileName+"/";return e},U=function(){return a.path.length==0?R:a.path[a.path.length-1]},w=_({value:[]}),a3=async function(e){await o3(),console.log("ss:",V.value.fileNodes),S(e)},B=function(){console.log("currentdir:",U()),a3(U()),console.log("this:",u.token),C.url="http://127.0.0.1:8088/usr/files?path="+b()+"&token="+u.token},c3=function(){C.visible.visible=!0,C.url="http://127.0.0.1:8088/usr/files?path="+b()+"&token="+u.token,console.log(C.url)},S=function(e){var I,E;console.log("a1:",e);const t=a.path.indexOf(e);t>=0?(a.path.splice(t+1),console.log("yy",a.path)):(a.path.splice(0),console.log("xx",a.path)),console.log("index",t),w.value.splice(0,w.value.length),console.log("sxz:",w.value);const l=V.value.fileNodes;console.log("a2:",l);const N=new Map(Object.entries(V.value.fileMap));if(l!=null)for(let m of l)m.ParentID==e.id&&(console.log("a3:",m),m.IsDir?(console.log("a4:"),w.value.push(new P(m.FileName,m.ID,"directory","",new L(new r(!1),"")))):w.value.push(new P(m.FileName,m.ID,(I=N.get(m.MapID.toString()))==null?void 0:I.Type,(E=N.get(m.MapID.toString()))==null?void 0:E.Url,new L(new r(!1),""))));console.log("sxxxxz:",w.value)},C=_({visible:new r(!1),url:"http://127.0.0.1:8088/usr/files?path="+b()+"&token="+u.token}),c=_({display:"none",currentFile:void 0,deleteFile(){var e;T.delete("/usr/files?token="+u.token,{params:{namespace:u.username,path:b(),fileName:(e=this.currentFile)==null?void 0:e.fileName}}).then(t=>{B(),console.log("\u5475\u5475\u5475",w.value.length),w.value.length<=1&&(console.log("\u554A\u54C8\u54C8"),a.path.pop(),S(U())),Y.success("\u5220\u9664\u6210\u529F")}).catch(t=>{Y.error("\u5220\u9664\u5931\u8D25")})},editFile(){this.currentFile!=null&&this.currentFile.type==".md"&&this.currentFile.url!=null&&fetch(this.currentFile.url).then(e=>e.text()).then(e=>{y.visible=!0,k.visible.visible=!0,k.markdownText=e})},renameFile(){}}),F=_({visible:new r(!1),createdFileName:""}),r3=function(){const e=F.createdFileName;e.endsWith("/")?(console.log("\u521B\u5EFA\u6587\u4EF6\u5939\uFF1A",e),T.post("/usr/directory?token="+u.token,{path:b(),dirName:e}).then(t=>{Y.success("\u521B\u5EFA\u6210\u529F"),F.createdFileName="",F.visible.visible=!1,B()})):console.log("\u521B\u5EFA\u6587\u4EF6\uFF1A",e)},z=_({visible:new r(!1),url:""});class Z{constructor(t,l){f(this,"visible");f(this,"markdownText");this.visible=t,this.markdownText=l}}const H=_(new Z(new r(!1),"")),k=_(new Z(new r(!1),"")),y=_({visible:!1,title:""}),u3=function(){var e;y.visible=!1,console.log("llll"),console.log(y.visible),z.visible.visible=!1,H.visible.visible=!1,k.visible.visible&&T.put("/usr/files?token="+u.token,{path:b(),fileName:(e=c.currentFile)==null?void 0:e.fileName,content:k.markdownText}).then(t=>{c.currentFile!=null&&(B(),k.visible.visible=!1)})},j=function(e){!e.target.closest(".fileMenu")&&c.display=="block"&&(c.display="none")};return g3(()=>{document.addEventListener("click",j),B()}),b3(()=>{document.removeEventListener("click",j)}),(e,t)=>{var q,G,J,W;const l=$("RouterLink"),N=$("v-md-preview"),I=$("v-md-editor"),E=f3,m=F3,d3=k3,p3=y3;return o(),n(O,null,[s("div",B3,[s("div",S3,[s("div",z3,[s("div",H3,[x(l,{to:"/"},{default:M(()=>[L3]),_:1}),T3]),s("div",{onClick:c3,class:"menuItem"},U3),s("div",{onClick:t[0]||(t[0]=i=>F.visible.visible=!0),class:"menuItem"},Y3),R3])]),s("div",Z3,[s("div",j3,[a.path.length?(o(),n("div",{key:0,onClick:t[1]||(t[1]=i=>S(R)),class:"filePathItem filePoint"},D(u.username),1)):d("",!0),a.path.length?d("",!0):(o(),n("strong",q3,D(u.username),1)),(o(!0),n(O,null,X(a.path,(i,g)=>(o(),n("div",G3,[J3,g!=a.path.length-1?(o(),n("div",{key:0,onClick:w6=>S(i),class:"filePathItem filePoint"},D(i.fileName),9,W3)):d("",!0),g==a.path.length-1?(o(),n("strong",X3,D(i.fileName),1)):d("",!0)]))),256))]),s("div",K3,[(o(!0),n(O,null,X(w.value.sort((i,g)=>i.id-g.id),i=>(o(),n("div",{class:"listItem",key:i.id},[i.type!="directory"?(o(),n("svg",Q3,s6)):d("",!0),i.type=="directory"?(o(),n("svg",i6,l6)):d("",!0),s("div",n6,[i.renameComponent.visible.visible?d("",!0):(o(),n("div",{key:0,onClick:g=>n3(i)},D(i.fileName),9,a6)),i.renameComponent.visible.visible?(o(),n("div",c6,[K(s("input",{"onUpdate:modelValue":g=>i.renameComponent.newName=g,type:"text"},null,8,r6),[[Q,i.renameComponent.newName]]),A(D(i.renameComponent.newName),1)])):d("",!0)]),s("div",{onClick:g=>l3(g,i),class:"fileMenu"},p6,8,u6)]))),128))])]),x(m3,{visible:F.visible.visible,onOnClose:t[3]||(t[3]=i=>F.visible.visible=!1)},{default:M(()=>[s("div",null," \u5F53\u524D\u4F4D\u7F6E\uFF1A"+D(u.username+"/"+b()),1),s("div",null,[A(" \u6587\u4EF6\u540D\uFF1A "),K(s("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>F.createdFileName=i)},null,512),[[Q,F.createdFileName]])]),s("div",{onClick:r3,class:"comfirm-btn"},[x(E3,null,{default:M(()=>[A(" \u786E\u5B9A ")]),_:1})])]),_:1},8,["visible"])]),s("div",{ref:"fileTip",style:s3({display:c.display}),class:"settingTooltip"},[((q=c.currentFile)==null?void 0:q.type)!="directory"?(o(),n("div",{key:0,onClick:t[4]||(t[4]=(...i)=>c.deleteFile&&c.deleteFile(...i)),class:"tipMenuItem"},"\u5220\u9664")):d("",!0),s("div",{onClick:t[5]||(t[5]=(...i)=>c.renameFile&&c.renameFile(...i)),class:"tipMenuItem"},"\u91CD\u547D\u540D"),((G=c.currentFile)==null?void 0:G.type)!="directory"?(o(),n("div",{key:1,onClick:t[6]||(t[6]=(...i)=>c.editFile&&c.editFile(...i)),class:"tipMenuItem"}," \u7F16\u8F91")):d("",!0),((J=c.currentFile)==null?void 0:J.type)!="directory"?(o(),n("div",v6,[s("a",{href:(W=c.currentFile)==null?void 0:W.url},"\u4E0B\u8F7D",8,h6)])):d("",!0)],4),x(E,{title:y.title,visible:y.visible,onDrawerClose:u3},{default:M(()=>[z.visible.visible?(o(),n("iframe",{key:0,src:z.url,frameborder:"0",width:"100%",height:"100%"},null,8,m6)):d("",!0),H.visible.visible?(o(),e3(N,{key:1,text:H.markdownText},null,8,["text"])):d("",!0),k.visible.visible?(o(),e3(I,{key:2,modelValue:k.markdownText,"onUpdate:modelValue":t[7]||(t[7]=i=>k.markdownText=i)},null,8,["modelValue"])):d("",!0)]),_:1},8,["title","visible"]),x(p3,{modelValue:C.visible.visible,"onUpdate:modelValue":t[8]||(t[8]=i=>C.visible.visible=i)},{default:M(()=>[x(d3,{"on-success":B,drag:"",action:C.url,multiple:""},{default:M(()=>[x(m,{class:"el-icon--upload"},{default:M(()=>[x(x3(C3))]),_:1}),f6]),_:1},8,["action"])]),_:1},8,["modelValue"])],64)}}});const x6=i3(_6,[["__scopeId","data-v-4b404ac3"]]);export{x6 as default};
